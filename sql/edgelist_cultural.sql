WITH greek_facebook_users AS (
	SELECT fu.uid, fu.name FROM facebook_users fu
		JOIN facebook_groups_users gu ON fu.uid = gu.uid
		JOIN facebook_groups fg ON gu.group_id = fg.group_id
		WHERE fg.group_id IN (358801190833478, 358739847506279, 617557238291204, 364881846892079, 358772894169641, 613203448726583, 790154174364842, 784111258302467, 407370042643259, 358782790835318, 452350961478500, 450603564986573, 804586659588260, 507051479341781, 359395334107397, 367996856580578, 454716677908595, 588169677896627, 714334568613470, 358721727508091, 666655193381408, 358728617507402, 62607020452895, 486526688060927, 715056245207969, 458414647538798, 676514102395517, 800678049979121, 561461737234088, 459523567427906, 787029648010628, 776153915764868, 681403838573210))
SELECT uid1 AS source, uid2 AS target
	FROM facebook_friends ff
	LEFT OUTER JOIN facebook_users fu1 ON ff.uid1=fu1.uid
	LEFT OUTER JOIN facebook_users fu2 ON ff.uid2=fu2.uid
	WHERE fu1.nu=1 AND fu2.nu=1 AND (uid1 IN (SELECT uid FROM greek_facebook_users) AND uid2 IN (SELECT uid FROM greek_facebook_users));